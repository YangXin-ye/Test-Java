<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.iweb.mapper.SqlOptimizeMapper">

    <!-- 通用查询结果列 -->


    <select id="list" resultType="com.iweb.entity.DbOrders">
        select id,user_id userId,order_date orderDate from db_orders
        limit 9000000,10
    </select>
    <select id="list2" resultType="com.iweb.entity.DbOrders">
        select t.id id,t.user_id userId,t.order_date orderDate from db_orders t , (
            select id from db_orders where id > 9000000 limit 10
        ) a where t.id = a.id;
    </select>
    <select id="list3" resultType="java.lang.Integer">
        SELECT
            count(*)
        FROM
            db_users u
                JOIN
            db_orders o ON u.id = o.user_id
                JOIN
            db_order_items od ON o.id = od.order_id
        WHERE od.product_name='product_444'
        ORDER BY
            u.id, o.id, od.id
    </select>
    <select id="list4" resultType="java.lang.Integer">
        SELECT
            count(*)
        FROM
            db_users u
                JOIN
            db_orders o ON u.id = o.user_id
                JOIN
            db_order_items od ON o.id = od.order_id
        WHERE od.product_name='product_444'
          and od.price > 50
        ORDER BY
            u.id, o.id, od.id
    </select>
    <select id="list5" resultType="java.lang.Integer">
        SELECT
            count(*)
        FROM
            db_users u
                JOIN
            db_orders o ON u.id = o.user_id
                JOIN
            db_order_items od ON o.id = od.order_id
        WHERE DATE(o.order_date) = '2023-01-01'
        ORDER BY
    u.id, o.id, od.id
    </select>
    <select id="list6" resultType="java.lang.Integer">
        SELECT
            count(*)
        FROM
            db_users u
                JOIN
            db_orders o ON u.id = o.user_id
                JOIN
            db_order_items od ON o.id = od.order_id
        WHERE o.order_date = '2023-01-01'
        ORDER BY
    u.id, o.id, od.id
    </select>
    <select id="list7" resultType="com.iweb.vo.SqlOptimizeVo">

        SELECT
            o.id AS order_id,
            u.username,
            u.email,
            o.order_date orderData,
            i.product_name productName,
            i.quantity,
            i.price
        FROM
            db_orders o
                JOIN
            db_users u ON o.user_id = u.id
                JOIN
            db_order_items i ON o.id = i.order_id
        WHERE
            u.username = 'user_1';
    </select>
</mapper>
